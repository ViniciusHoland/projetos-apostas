<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Editar Jogo</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script>
      function adicionarOddPersonalizada() {
        const container = document.getElementById(
          "oddsPersonalizadasContainer"
        );
        const index = container.children.length;
        const html = `
        <div class="row mb-2">
          <div class="col">
            <input type="text" name="oddsPersonalizadas[${index}][descricao]" class="form-control" placeholder="Descrição" />
          </div>
          <div class="col">
            <input type="number" step="0.01" name="oddsPersonalizadas[${index}][valor]" class="form-control" placeholder="Valor" />
          </div>
        </div>
      `;
        container.insertAdjacentHTML("beforeend", html);
      }
    </script>
  </head>
  <body class="container mt-5">
    <h1>Editar Jogo</h1>
    <form action="/jogos/editar/<%= jogo._id %>" method="POST">
      <div class="mb-3">
        <label class="form-label">Time Casa</label>
        <input
          type="text"
          name="timeCasa"
          class="form-control"
          value="<%= jogo.timeCasa %>"
          required
        />
      </div>
      <div class="mb-3">
        <label class="form-label">Time Fora</label>
        <input
          type="text"
          name="timeFora"
          class="form-control"
          value="<%= jogo.timeFora %>"
          required
        />
      </div>
      <div class="mb-3">
        <label class="form-label">Data e Hora</label>
        <% let dataFormatada = new Date(jogo.dataHora); let ano =
        dataFormatada.getFullYear(); let mes = String(dataFormatada.getMonth() +
        1).padStart(2, '0'); let dia =
        String(dataFormatada.getDate()).padStart(2, '0'); let horas =
        String(dataFormatada.getHours()).padStart(2, '0'); let minutos =
        String(dataFormatada.getMinutes()).padStart(2, '0'); let dataFinal =
        `${ano}-${mes}-${dia}T${horas}:${minutos}`; %>

        <input
          type="datetime-local"
          name="dataHora"
          class="form-control"
          value="<%= dataFinal %>"
          required
        />
      </div>
      <div class="mb-3">
        <label class="form-label">Odd Casa</label>
        <input
          type="number"
          step="0.01"
          name="oddCasa"
          class="form-control"
          value="<%= jogo.oddCasa %>"
        />
      </div>
      <div class="mb-3">
        <label class="form-label">Odd Empate</label>
        <input
          type="number"
          step="0.01"
          name="oddEmpate"
          class="form-control"
          value="<%= jogo.oddEmpate %>"
        />
      </div>
      <div class="mb-3">
        <label class="form-label">Odd Fora</label>
        <input
          type="number"
          step="0.01"
          name="oddFora"
          class="form-control"
          value="<%= jogo.oddFora %>"
        />
      </div>

      <h5>Adicionar Odds Personalizadas</h5>
      <div id="oddsPersonalizadasContainer">
        <% if (jogo.oddsPersonalizadas && jogo.oddsPersonalizadas.length > 0) {
        %> <% jogo.oddsPersonalizadas.forEach((odd, index) => { %>
        <div class="row mb-2">
          <div class="col">
            <input
              type="text"
              name="oddsPersonalizadas[<%= index %>][descricao]"
              class="form-control"
              value="<%= odd.descricao %>"
              placeholder="Descrição"
            />
          </div>
          <div class="col">
            <input
              type="number"
              step="0.01"
              name="oddsPersonalizadas[<%= index %>][valor]"
              class="form-control"
              value="<%= odd.valor %>"
              placeholder="Valor"
            />
          </div>
        </div>
        <% }); %> <% } %>
      </div>

      <button
        type="button"
        class="btn btn-outline-primary mb-3"
        onclick="adicionarOddPersonalizada()"
      >
        Adicionar Odd
      </button>
      <br />
      <button type="submit" class="btn btn-success">Salvar Alterações</button>
      <a href="/jogos" class="btn btn-secondary ms-2">Cancelar</a>
    </form>
  </body>
</html>
